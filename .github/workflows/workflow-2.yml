name: This is second workflow
on:
  - push
jobs:
 firstJob:
   needs: my_third_job
   runs-on: ubuntu-latest
   env:
      hostname: DevOps
      app: githubaction
   steps:
      - name: Checking the hostname
        run: |
          sudo hostname
      - name: Set New hostname
        run: |
          sudo hostnamectl set-hostname "$hostname"
          hostname
      - name: Checking the Condition using Env
        if: ${{ env.app == 'githubaction' }}
        run: echo "True"

 my_second_job:
            needs: my_third_job
            runs-on: ubuntu-latest
            steps:
             -  name : Installing with NPM
                run: |
                 if [ -e yarn.lock ]; then
                 yarn install --frozen-lockfile
                 elif [ -e package-lock.json ]; then
                 npm ci
                 else
                 npm i
                 fi
             #- uses: actions/checkout@v3
             #- uses: actions/setup-node@v3
             # with:
             # node-version: 18
             #- run: npm ci
             - run: npm test    
            # - name: Copy Json to runner
            #   run: cp package.json /home/runner/work/demo/demo/package.json
            #  - name: Installing npm 
            #    run: npm install
             - name: Build 
               run: npm run build
 
 my_third_job:
            runs-on: ubuntu-latest
            steps: 
            - name: Job 3
              run: echo "Third job Execution ."
 my_fourth_job: 
            needs: my_second_job
            runs-on: ubuntu-latest
            steps: 
             - name: Cache node modules
               id: cache-npm
               uses: actions/cache@v3
               with: 
                    path: ~/.npm
             - if: ${{ steps.cache-npm.outputs.cache-hit != 'true' }}
               name: List the state of node modules
               continue-on-error: true
               run: npm list
             - name: Install dependencies
               run: npm install
       
             - name: Build
               run: npm run build
       
             - name: Test
               run: npm test